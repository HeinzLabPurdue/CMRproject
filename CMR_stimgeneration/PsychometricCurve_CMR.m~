% File: PsychometricCurve_CMR.m
% Created: Fernando Aguilera - Jun 28 2020
% Last Modified by: Fernando Aguilera de Alba - July 1 2020
%% Goal
% Generate psychometric curver for REF, CORR, and ACORR conditions from user data for CMR pilot testing.
clear all;close all;clc;
%% Requirement
% Load all 3 blocks from user files from CMRpilot_results folder
cd CMRpilot_results % open pilot data folder 
blocks = input('How many blocks of data will you analyze?: ');
% create vector for each condition with data from all blocks
for i = 1:blocks
    fprintf('\nBlock #%d\n',i);
    block = input('Filename: ');
    load(block);
    REFresults_avg(:,i+1) = (REFtonescore(:,2)/2)*100;
    CORRresults_avg(:,i+1) = (CORRtonescore(:,2)/2)*;
    ACORRresults_avg(:,i+1) = (ACORRtonescore(:,2);
end
REFresults_avg(:,1) = levelVEC_tone_dBSPL'; CORRresults_avg(:,1) = levelVEC_tone_dBSPL'; ACORRresults_avg(:,1) = levelVEC_tone_dBSPL';
%% Average results
REF = 0; CORR = 0; ACORR = 0;
for j = 1:length(levelVEC_tone_dBSPL)
    for i = 1:blocks
        REF = REF + REFresults_avg(j,i+1);
        CORR = CORR + CORRresults_avg(j,i+1);
        ACORR = ACORR + ACORRresults_avg(j,i+1);
    end
    REFresults_avg(j,(blocks+2)) = (REF/blocks)*100/2;
    CORRresults_avg(j,(blocks+2)) = (CORR/blocks)*100/2;
    ACORRresults_avg(j,(blocks+2)) = (ACORR/blocks)*100/2;
    REF = 0; CORR = 0; ACORR = 0;
end
%% Psychometric curve generation
for i = 1:(blocks+2)
figure;
subplot(1,3,1); % REF 
scatter(REFresults_avg(:,1),REFresults_avg(:,i),'*','LineWidth', 1.5); % scatter plot of average REF
title('Psychometric Curve (Condition: REF)');
xlabel('Tone Level (dB)'); ylabel('Average Correctness (%)');
ylim([0,110]);
subplot(1,3,2); % CORR
scatter(CORRresults_avg(:,1),CORRresults_avg(:,i),'*','LineWidth', 1.5); % scatter plot of average CORR
title('Psychometric Curve (Condition: CORR)');
xlabel('Tone Level (dB)'); ylabel('Average Correctness (%)');
ylim([0,110]);
subplot(1,3,3); % ACORR
scatter(ACORRresults_avg(:,1),ACORRresults_avg(:,i),'*','LineWidth', 1.5); % scatter plot of average ACORR
title('Psychometric Curve (Condition: ACORR)');
xlabel('Tone Level (dB)'); ylabel('Average Correctness (%)');
ylim([0,110]);
end
